name: Build Kohksh for Linux

on: [push, pull_request, workflow_dispatch]

jobs:
  build-linux:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    
    - name: Install dependencies
      run: |
        sudo apt-get update
        sudo apt-get install -y \
          build-essential \
          cmake \
          pkg-config \
          git \
          # کتابخانه‌های SDL2
          libsdl2-dev \
          libsdl2-image-dev \
          libsdl2-ttf-dev \
          libsdl2-mixer-dev \
          # کتابخانه‌های OpenGL
          libgl1-mesa-dev \
          libglu1-mesa-dev \
          libglew-dev \
          # کتابخانه‌های صوتی
          libopenal-dev \
          libvorbis-dev \
          libflac-dev

    - name: Build simple version
      run: |
        chmod +x build-simple.sh
        ./build-simple.sh

    - name: Upload Binary
      uses: actions/upload-artifact@v4
      with:
        name: kohksh-linux
        path: |
          kohksh
          kohksh-simple
